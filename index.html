<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <meta name="description" content="Творческий уголок Альберта. Версия для TV."/>
    <meta name="keywords"
          content="guitar, music, songs, музыка, песни под гитару, творчество, авторские песни, гитара, нити времени 2022"/>
    <meta name="author" content="albertsongs"/>
    <meta property="og:url" content="https://albertsongs.github.io/tv"/>
    <meta property="og:title" content="albertsongs"/>
    <meta property="og:description" content="Творческий уголок Альберта. Версия для TV."/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://albertsongs.github.io/background.png"/>
    <link rel="canonical" href="https://albertsongs.github.io/tv">
    <title>albertsongs TV</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico"/>
    <link href="css/styles.css" rel="stylesheet"/>
</head>
<body>
<iframe id="videoPlayer" width="100%"
        src="https://www.youtube.com/embed/videoseries?autoplay=1&controls=1
                &list=PLjv4Gt_enoJvL5QUt1H3bv9F3Omuj9n3g&loop=1&cc_load_policy=1&color=white"
        title="Нити времени (2022)" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;
                picture-in-picture" allowfullscreen></iframe>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script type="text/javascript" src="js/scripts.js"></script>
<script type="text/javascript" src="js/app.js"></script>
<script type="text/javascript">
    let apiUrl = 'https://albertsongs.asuscomm.com';
    let receiverId = localStorage.getItem('receiverId');
    let changeReceiverIdHandler = (receiverId) => localStorage.setItem('receiverId', receiverId);
    let messageHandler = (mess) => {
        const messContainer = JSON.parse(mess.body);
        const command = JSON.parse(messContainer.message);
        if(command.type === 'PLAY_YOUTUBE_VIDEO' && command.payload !== null){
            loadVideo(command.payload);
        }
        console.log(mess);
    };
    let loadVideo = (videoInfo) => {
        const youtubeLinkPattern = "https://www.youtube.com/embed/%videoId%?autoplay=1&cc_load_policy=1" +
            "&list=%playlistId%&listType=playlist&loop=1&color=white";
        document.getElementById("videoPlayer").src = youtubeLinkPattern
            .replace('%videoId%', videoInfo.youtube.videoId)
            .replace('%playlistId%', videoInfo.youtube.playlistId);
    }
    let app = new App(apiUrl, receiverId, changeReceiverIdHandler, messageHandler);
    app.registerReceiver();
</script>
</body>
</html>
